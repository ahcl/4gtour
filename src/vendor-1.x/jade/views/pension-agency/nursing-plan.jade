.col-xs-2(ng-if="vm.switches.leftTree")
    .tree.tree-basic(name='yAxisData',s-tree, s-tree-data="vm.yAxisDataPromise",s-tree-height="vm.size.h-15", s-tree-template-url='tree-directive-default-renderer.html',s-tree-option="{mode:'check',selectNodeFormat:'object'}",ng-model="vm.yAxisData",required='', on-check-change="vm.onRoomChange()")
.text-left(ng-class='{"col-xs-10":vm.switches.leftTree,"col-xs-12":!vm.switches.leftTree}')
    .row
        .col-md-5.text-left
            .btn-toolbar
                .btn-group
                    ui-select(name="nursingPlanTemplates",theme='bootstrap', ng-Model="vm.selectedNursingPlanTemplate" ,ng-style='{width: "180px"}')
                        ui-select-match(placeholder='{{vm.moduleTranslatePath("PLACEHOLDER-PICK_NURSING_PLAN_TEMPLATE")|translate}}') {{$select.selected.name}}
                        ui-select-choices(repeat='nursingPlanTemplates in vm.selectBinding.nursingPlanTemplates | filter: {name: $select.search}')
                            div(ng-bind-html='nursingPlanTemplates.name | highlight: $select.search')
                .btn-group
                    a.btn.btn-warning.btn-sm(ng-click="vm.importTemplate()") {{ vm.moduleTranslatePath('BTN-IMPORT-TEMPLATE') | translate}}
                .btn-group
                    a.btn.btn-success.btn-sm(ng-click="vm.saveAsTemplate()") {{ vm.moduleTranslatePath('BTN-SAVE-TEMPLATE') |translate}}
        .col-md-7
            .btn-toolbar.pull-right
                .btn-group
                    a.btn.btn-primary.btn-sm(title="{{vm.moduleTranslatePath('BTN-PRE-WEEK')|translate}}",ng-click="vm.preWeek()")
                        i.glyphicon.glyphicon-chevron-left
                        | {{vm.moduleTranslatePath('BTN-PRE-WEEK')|translate}}
                .btn-group
                    a.btn.btn-primary.btn-sm(title="{{vm.moduleTranslatePath('BTN-NEXT-WEEK')|translate}}",ng-click="vm.nextWeek()")
                        i.glyphicon.glyphicon-chevron-right
                        | {{vm.moduleTranslatePath('BTN-NEXT-WEEK')|translate}}
                .btn-group
                    ui-select(name="nursingWorkers",theme='bootstrap', ng-Model="vm.selectedNursingWorker" ,ng-style='{width: "120px"}')
                        ui-select-match(placeholder='{{vm.moduleTranslatePath("PLACEHOLDER-PICK_NURSING_WORKER")|translate}}') {{$select.selected.name}}
                        ui-select-choices(repeat='nursingWorker in vm.selectBinding.nursingWorkers | filter: {name: $select.search}')
                            div(ng-bind-html='nursingWorker.name | highlight: $select.search')
                .btn-group
                    a.btn.btn-primary.btn-sm(ng-click="vm.saveSelected()") {{'button.SAVE'|translate}}
                .btn-group
                    a.btn.btn-danger.btn-sm(ng-click="vm.removeSelected()") {{'button.REMOVE'|translate}}
    .row-split
    .panel.panel-default.panel-grid
        table.grid.table.table-bordered.table-striped.nursing-plan-table
            thead
                tr
                    th.text-center(ng-click="vm.selectGrid()" width="100") {{ vm.moduleTranslatePath('LABEL-YAXIS_LABEL') | translate}}
                    th.text-center(title="{{vm.moduleTranslatePath('TITLE-COL')|translate}}",ng-repeat="column in vm.xAxisData",width="100",ng-click="vm.selectGridCol(column._id)") {{::column.name}}
            tbody
                tr(ng-repeat="row in vm.yAxisData")
                    td.text-center(title="{{vm.moduleTranslatePath('TITLE-ROW')|translate}}",ng-click="vm.selectGridRow(row._id)")
                        | {{::row.name}}
                    td.text-center(ng-repeat="col in vm.xAxisData",width="100", ng-class='{"grid-cell-selected": vm.cells[row._id][col._id] }',ng-click="vm.selectGridCell(row._id,col._id)" )
                        span {{(vm.aggrData[row._id][col._id] || {}).name }}
                tr(ng-if="vm.yAxisData.length==0")
                    td.text-center(colspan="{{vm.xAxisData.length + 1}}") {{ 'grid.NO-RESULTS' | translate}}

script(type="text/ng-template", id="nursing-plan-save-as-template.html")
    form.form-validate.mb-lg(role='form', name="theForm", novalidate='', ng-submit="vm.saveAsTemplate()")
        .ngdialog-message
            h3.mt0 {{ vm.title | translate}}
        .ngdialog-input
            fieldset: .form-group
                .col-md-4
                    .panel-heading.bg-primary {{ vm.viewTranslatePath('TAB3-LABEL-SETTLEMENT_INFO-ADVANCE_PAYMENT_AMOUNT') | translate}}
                        span.pull-right.text-white.text-sm.text-italic {{'label.TOTAL1'|translate}}：{{vm.advancePayment|currency}}
                    table.grid.table.table-bordered.table-white(ng-init="vm.advancePayment=0")
                        tbody
                            tr(ng-repeat="row in vm.advancePaymentItems" ng-click="vm.grid.selectRow($event,row)",ng-init="vm.advancePayment=vm.advancePayment+row.amount")
                                td.text-left.text-sm(width="160") {{::row.digest}}
                                td.text-right.text-primary.text-italic(width="80") {{::row.amount|currency}}
                .col-md-4
                    .panel-heading.bg-danger {{ vm.viewTranslatePath('TAB3-LABEL-SETTLEMENT_INFO-RECORDED_CHARGE_TOTAL') | translate}}
                        span.pull-right.text-white.text-sm.text-italic {{'label.TOTAL1'|translate}}：{{vm.recorded_charge_total|currency}}
                    table.grid.table.table-bordered.table-white(ng-init="vm.recorded_charge_total=0")
                        tbody
                            tr(ng-repeat="row in vm.chargeItemsRecorded" ng-click="vm.grid.selectRow($event,row)",ng-init="vm.recorded_charge_total=vm.recorded_charge_total+row.amount")
                                td.text-left.text-sm(width="160") {{::row.digest}}
                                td.text-right.text-italic(width="80",ng-class='{"text-danger":row.amount>=0,"text-primary":row.amount<0}') {{::row.amount|currency}}
                .col-md-4
                    .panel-heading.bg-danger {{ vm.viewTranslatePath('TAB3-LABEL-SETTLEMENT_INFO-UNRECORDED_CHARGE_TOTAL') | translate}}
                        span.pull-right.text-white.text-sm.text-italic {{'label.TOTAL1'|translate}}：{{vm.unrecorded_charge_total|currency}}
                    table.grid.table.table-bordered.table-white(ng-init="vm.unrecorded_charge_total=0")
                        tbody
                            tr(ng-repeat="row in vm.chargeItemsUnRecorded" ng-click="vm.grid.selectRow($event,row)",ng-init="vm.unrecorded_charge_total=vm.unrecorded_charge_total+row.amount")
                                td.text-left.text-sm(width="160") {{::row.digest}}
                                td.text-right.text-italic(width="80",ng-class='{"text-danger":row.amount>=0,"text-primary":row.amount<0}') {{::row.amount|currency}}
